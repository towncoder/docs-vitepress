ã€pythonå®æˆ˜ã€‘ä¸ç©çœ‹å¾®åšï¼Œä¸€å°é‚®ä»¶å°±èƒ½çŸ¥é“å®æ—¶çƒ­æ¦œï¼Œå¤©ç§€åƒç“œ

â¤ï¸<font color=orange>æ¬¢è¿è®¢é˜…[ã€Šä»å®æˆ˜å­¦pythonã€‹](https://blog.csdn.net/skylibiao/category_7934680.html?spm=1001.2014.3001.5482)ä¸“æ ï¼Œç”¨pythonå®ç°åŠå…¬è‡ªåŠ¨åŒ–ã€æ•°æ®å¯è§†åŒ–ã€äººå·¥æ™ºèƒ½ç­‰å„ä¸ªæ–¹å‘çš„å®æˆ˜æ¡ˆä¾‹ï¼Œæœ‰è¶£åˆæœ‰ç”¨ï¼</font>â¤ï¸

[æ›´å¤šç²¾å“ä¸“æ ç®€ä»‹ç‚¹è¿™é‡Œ](https://blog.csdn.net/skylibiao/article/details/119297018?spm=1001.2014.3001.5502)

>æœ‰çš„äººé‡‘ç‰å…¶è¡¨è´¥çµ®å…¶ä¸­ï¼Œæœ‰çš„äººå´è‹¥å½©è™¹èˆ¬ç»šçƒ‚ï¼Œæ€¦ç„¶å¿ƒåŠ¨

# å‰è¨€

å“ˆå–½ï¼Œå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸€æ¡ã€‚

åœ¨ç”Ÿæ´»ä¸­æˆ‘æ˜¯ä¸€ä¸ªä¸å¤ªå–œæ¬¢é€›å¨±ä¹å¹³å°çš„äººï¼ŒæŠ–éŸ³ã€å¿«æ‰‹ã€å¾®åšæˆ‘æ‰‹æœºé‡Œéƒ½æ²¡è£…ï¼Œç”šè‡³å¾®ä¿¡æœ‹å‹åœˆéƒ½ä¸çœ‹ï¼Œä½†æ˜¯è‡ªä»å¼€å§‹å†™åšå®¢ï¼Œæœ‰äº›çƒ­åº¦ä¸å¾—ä¸è¹­ï¼Œæ¯”å¦‚æœ€è¿‘çš„å´æŸï¼Œé¸¿æ˜ŸæŸå…‹ã€‚

æ‰€ä»¥å°±æœ‰äº†è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œèƒ½ä¸èƒ½è®©å¾®åšä¸»åŠ¨æŠŠçƒ­æ¦œæ¨ç»™æˆ‘å‘¢ï¼Ÿè‚¯å®šæ˜¯ä¸è¡Œï¼Œå¾®åšåˆä¸æ˜¯æˆ‘å®¶å¼€çš„ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ

äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨pythonã€‚æ–¹æ¡ˆå¦‚ä¸‹ï¼š

- æ¯éš”ä¸€å°æ—¶çˆ¬å–ä¸€æ¬¡å¾®åšçƒ­æ¦œ
- å°†çƒ­æ¦œå†…å®¹é€šè¿‡é‚®ä»¶æ¨é€ç»™æˆ‘

è¯ä¸å¤šè¯´ï¼Œå¼€å¹²

# çˆ¬å–çƒ­æ¦œ

>å¾®åšçš„çƒ­æ¦œå¹¶æ²¡æœ‰ç™»å½•éªŒè¯ï¼Œæ“ä½œèµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä¸€ä¸ªè¯·æ±‚è¿‡å»ï¼Œç„¶åè§£æ`html`å°±è¡Œäº†ã€‚
>
>ä»¥å‰æˆ‘ä»¬éƒ½æ˜¯ç”¨`xpath`è§£æï¼Œä»Šå¤©å¸¦å¤§å®¶ä½“éªŒä¸€ä¸‹`BeautifulSoup`

## url

çƒ­æ¦œurlï¼šhttp://s.weibo.com/top/summary

è¯·æ±‚å‚æ•°ï¼š

```json
data = {
    'cate': 'realtimehot'
}

```

è¯·æ±‚`headers`ï¼š

```json

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
}
```

## è§£æç½‘é¡µ

macå¿«æ·é”®` alt+command+i`æ‰“å¼€å¼€å‘è€…å·¥å…·

![image-20210802202211916](https://img-blog.csdnimg.cn/img_convert/25ae7564cdcc7bddd806326d0dea2507.png)

å®šä½åˆ°çƒ­æ¦œæ‰€åœ¨çš„`<div>`é‡Œï¼Œå‘ç°çƒ­åº¦å’Œçƒ­æ¦œå†…å®¹éƒ½ä½äº`<a>`æ ‡ç­¾ã€‚ä¸€æ¡çƒ­æ¦œæ˜¯ä¸€ä¸ª`<tr>`ã€‚

åˆ†æå®Œè¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥è§£æç½‘é¡µäº†ã€‚

## code

```python
def get_content():
    try:
        res = requests.get('http://s.weibo.com/top/summary?', params=data, headers=headers)
        if res.status_code == 200:
            html = res.text
            soup = BeautifulSoup(html, 'lxml')
            tr = soup.find(id='pl_top_realtimehot').find_all('tr', class_="")
            hotSearch = ""
            for i, item in enumerate(tr):
                if i > 0:
                    title = item.find('a').get_text()
                    url = "https://s.weibo.com" + item.find('a').attrs['href']
                    hot = item.find('span').get_text()
                    id = item.find('td', class_="td-01 ranktop").get_text()
                    hotSearch += id + '\t' + title + "\t" + hot + "\t" + url + "\n"
            print(hotSearch)
            return hotSearch
    except:
        print("è®¿é—®å¤±è´¥")
```

çœ‹ä¸€ä¸‹æ§åˆ¶å°è¾“å‡ºï¼š

![image-20210802205314582](https://img-blog.csdnimg.cn/img_convert/dc31951ad7620b48d1c65aadc1937612.png)

åŒ…å« æ’åã€å†…å®¹ã€çƒ­åº¦ã€urlï¼Œä¸‹é¢åªéœ€è¦å°†è¿™äº›å†…å®¹å‘é€åˆ°é‚®ç®±å°±å¯ä»¥äº†ã€‚

# å‘é‚®ä»¶

>å­¦ä¼šç”¨pythonå‘é‚®ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè®¸å¤šæ„æƒ³ä¸åˆ°çš„æ“ä½œï¼Œå¤§å®¶è¦è®¤çœŸçœ‹å“¦ï¼




## é‚®ç®±é…ç½®

é¦–å…ˆéœ€è¦é…ç½®æˆ‘ä»¬çš„é‚®ç®±ï¼Œå¼€å¯`smtp`åè®®ï¼Œ`smtp`æ˜¯ä¸€ç§æä¾›å¯é ä¸”æœ‰æ•ˆçš„ç”µå­é‚®ä»¶ä¼ è¾“çš„ä¸€ç§é‚®ä»¶æœåŠ¡ï¼Œä¸»è¦ç”¨äºç³»ç»Ÿä¹‹é—´çš„é‚®ä»¶ä¿¡æ¯ä¼ é€’ï¼Œå¹¶æä¾›æœ‰å…³æ¥ä¿¡çš„é€šçŸ¥ã€‚

æœ¬æ–‡ä»¥qqé‚®ç®±ä¸ºä¾‹è¿›è¡Œé…ç½®ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼›

- ç™»å½•é‚®ç®±ï¼Œè¿›å…¥è®¾ç½®
- ç‚¹å‡»å¼€å¯`smtp`
- æŒ‰ç…§æç¤ºå‘é€ä¿¡æ¯åˆ°æŒ‡å®šå·ç 
- å®Œæˆåç‚¹å‡»æˆ‘å·²å‘é€
- å°†keyè®°å½•ä¸‹æ¥ï¼Œåé¢è¦ç”¨

![image-20210801144213272](https://img-blog.csdnimg.cn/img_convert/e137e11698d96db7b0bce08bcb01a48e.png)



## å‘é€é‚®ä»¶

>å…·ä½“é‚®ä»¶çš„å‘é€æˆ‘ä»¬é€šè¿‡`smtplib`è¿™ä¸ªåº“æ¥å®ç°

#### å®‰è£…

```python
pip install smtplib
```

é…ç½®é‚®ç®±ä¿¡æ¯ï¼š

```python
 	mail_host = 'smtp.qq.com'
    mail_user = '2865866423'
    #å°†passæ›¿æ¢æˆåˆšåˆšä¿å­˜çš„key
    mail_pass = 'your pass'
```

#### æç¤º

qqé‚®ç®±æ”¯æŒè‡ªå·±ç»™è‡ªå·±å‘é‚®ä»¶

#### é‚®ä»¶å†…å®¹

```python
# é‚®ä»¶å†…å®¹è®¾ç½®ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹æˆä½ è¦å‘é€çš„å†…å®¹å³å¯
message = MIMEText(message, 'plain', 'utf-8')
# é‚®ä»¶ä¸»é¢˜
message['Subject'] = 'å¾®åšçƒ­æœ'
# å‘é€æ–¹ä¿¡æ¯
message['From'] = sender
# æ¥å—æ–¹ä¿¡æ¯
message['To'] = receivers[0]
```

è®¾ç½®å¥½è¿™äº›ï¼Œåªéœ€è¦ç™»å½•é‚®ç®±æœåŠ¡å™¨å‘é€å°±å¥½äº†

#### å®Œæ•´ä»£ç 

```python
def send_mail(message):
    mail_host = 'smtp.qq.com'
    mail_user = ''
    mail_pass = ''

    # å‘é€æ–¹ï¼Œå¯ä»¥è‡ªå·±ç»™è‡ªå·±å‘
    sender = '@qq.com'
    # é‚®ä»¶æ¥å—æ–¹é‚®ç®±åœ°å€ï¼Œå¯å¤šå†™
    receivers = ['@qq.com']

    # é‚®ä»¶å†…å®¹è®¾ç½®ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹æˆä½ è¦å‘é€çš„å†…å®¹å³å¯
    message = MIMEText(message, 'plain', 'utf-8')
    # é‚®ä»¶ä¸»é¢˜
    message['Subject'] = 'å¾®åšçƒ­æœ'
    # å‘é€æ–¹ä¿¡æ¯
    message['From'] = sender
    # æ¥å—æ–¹ä¿¡æ¯
    message['To'] = receivers[0]
    
    try:
        smtpObj = smtplib.SMTP_SSL(mail_host)
        # ç™»å½•åˆ°æœåŠ¡å™¨
        smtpObj.login(mail_user, mail_pass)
        # å‘é€
        smtpObj.sendmail(
            sender, receivers, message.as_string())
        # é€€å‡º
        smtpObj.quit()
        print('success')
    except smtplib.SMTPException as e:
        print('error', e)  # æ‰“å°é”™è¯¯
```

#### æµ‹è¯•ä¸€ä¸‹

>å·²ç»æ”¶åˆ°äº†ä¸»é¢˜ä¸ºã€Œå¾®åšçƒ­æœã€çš„é‚®ä»¶

![image-20210801143938144](https://img-blog.csdnimg.cn/img_convert/7ad364090711db0131921ef9a8b62247.png)

# å®šæ—¶æ‰§è¡Œ

>ä¸ºäº†å®æ—¶çš„æŸ¥çœ‹çƒ­æ¦œï¼Œéœ€è¦å°†è„šæœ¬æ”¾åˆ°æœåŠ¡å™¨ï¼Œæ¯å°æ—¶å®šæ—¶æ‰§è¡Œä¸€æ¬¡ã€‚

å‘½ä»¤

```shell
crontab -e
0 * * * * python /hot_monitor.py
```

å…³äº`0 * * * *`è¿™å‡ ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œè¯·è‡ªè¡Œç™¾åº¦ã€‚

å…³äºäº‘æœåŠ¡å™¨ï¼Œå¯ä»¥å‚è€ƒä¸€æ¡è¿™ç¯‡æ–‡ç« [ã€Šé˜¿é‡Œäº‘æœåŠ¡å™¨è´­ä¹°åŠSSHå…å¯†ç™»å½•ã€‹](https://blog.csdn.net/skylibiao/article/details/109729785)è¿›è¡Œè´­ä¹°å’Œé…ç½®ã€‚



# ğŸŒˆå¯»å®

>â­ä»Šå¤©æ˜¯åšæŒåˆ·é¢˜æ›´æ–‡çš„ç¬¬**20**/100å¤©
>
>â­å„ä½çš„<font color=orange>ç‚¹èµã€å…³æ³¨ã€æ”¶è—ã€è¯„è®ºã€è®¢é˜…</font>å°±æ˜¯ä¸€æ¡åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›
>

ä¸ºäº†å›é¦ˆå„ä½ç²‰ä¸ï¼Œç¤¼å°šå¾€æ¥ï¼Œç»™å¤§å®¶å‡†å¤‡äº†ä¸€æ¡å¤šå¹´ç§¯ç´¯ä¸‹æ¥çš„ä¼˜è´¨èµ„æºï¼ŒåŒ…æ‹¬<font color=orange> å­¦ä¹ è§†é¢‘ã€é¢è¯•èµ„æ–™ã€çè—ç”µå­ä¹¦ç­‰</font>

å¤§å®¶å¯ä»¥<font color=orange>è¯„è®ºç•™è¨€æˆ–è€…ç§ä¿¡</font>æˆ‘é¢†å–

![](https://img-blog.csdnimg.cn/54bc192590174279ad876040029fdf12.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NreWxpYmlhbw==,size_16,color_FFFFFF,t_70)
